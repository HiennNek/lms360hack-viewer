{"ast":null,"code":"import{useState}from\"react\";import PlayH5p from\"./components/PlayH5p\";import{saveH5P}from\"./services/h5p-storage\";import\"./styles.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function App(){const[h5pPath,setH5pPath]=useState(\"./h5p/for-or-since\");const[loading,setLoading]=useState(false);const handleFileChange=async event=>{const file=event.target.files[0];if(!file)return;setLoading(true);try{const id=await saveH5P(file);// Construct the virtual path that the SW intercepts\n// We'll point to the root of the extracted content\n// Note: h5p-standalone expects the path to CONTAIN h5p.json\n// Our saveH5P saves files with their relative paths.\n// So if h5p.json is at the root of the zip, we point to `/_h5p/` \n// NOT `/_h5p/${id}` because we didn't prefix the storage keys with ID in this simple version\n// Wait, in h5p-storage.js I wrote: `return store.put(blob, relativePath);`\n// So the file is at simply \"h5p.json\". \n// The SW intercepts /_h5p/* and looks up the star part.\n// So we should point h5p-standalone to `/_h5p`? \n// h5p-standalone appends /h5p.json. So `/_h5p/h5p.json` -> SW looks up \"h5p.json\". Correct.\n// Force a remount or update by changing the key or path\n// Since we cleared the DB, previous content is gone.\nsetH5pPath(\"/_h5p\");}catch(error){console.error(\"Error processing H5P file:\",error);alert(\"Failed to load H5P file\");}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"H5P Standalone in React\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:\"20px\",padding:\"10px\",border:\"1px solid #ccc\"},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Upload .h5p file\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".h5p,.zip\",onChange:handleFileChange}),loading&&/*#__PURE__*/_jsx(\"span\",{children:\" Loading...\"})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"H5P Content\"}),!loading&&/*#__PURE__*/_jsx(PlayH5p,{h5pJsonPath:h5pPath},h5pPath+Date.now())]});}","map":{"version":3,"names":["useState","PlayH5p","saveH5P","jsx","_jsx","jsxs","_jsxs","App","h5pPath","setH5pPath","loading","setLoading","handleFileChange","event","file","target","files","id","error","console","alert","className","children","style","marginBottom","padding","border","type","accept","onChange","h5pJsonPath","Date","now"],"sources":["/home/hien/Downloads/h5p-standalone-in-react-1-forked/src/App.js"],"sourcesContent":["import { useState } from \"react\";\nimport PlayH5p from \"./components/PlayH5p\";\nimport { saveH5P } from \"./services/h5p-storage\";\nimport \"./styles.css\";\n\nexport default function App() {\n  const [h5pPath, setH5pPath] = useState(\"./h5p/for-or-since\");\n  const [loading, setLoading] = useState(false);\n\n  const handleFileChange = async (event) => {\n    const file = event.target.files[0];\n    if (!file) return;\n\n    setLoading(true);\n    try {\n      const id = await saveH5P(file);\n      // Construct the virtual path that the SW intercepts\n      // We'll point to the root of the extracted content\n      // Note: h5p-standalone expects the path to CONTAIN h5p.json\n      // Our saveH5P saves files with their relative paths.\n      // So if h5p.json is at the root of the zip, we point to `/_h5p/` \n      // NOT `/_h5p/${id}` because we didn't prefix the storage keys with ID in this simple version\n      // Wait, in h5p-storage.js I wrote: `return store.put(blob, relativePath);`\n      // So the file is at simply \"h5p.json\". \n      // The SW intercepts /_h5p/* and looks up the star part.\n      // So we should point h5p-standalone to `/_h5p`? \n      // h5p-standalone appends /h5p.json. So `/_h5p/h5p.json` -> SW looks up \"h5p.json\". Correct.\n\n      // Force a remount or update by changing the key or path\n      // Since we cleared the DB, previous content is gone.\n      setH5pPath(`/_h5p`);\n    } catch (error) {\n      console.error(\"Error processing H5P file:\", error);\n      alert(\"Failed to load H5P file\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"App\">\n      <h1>H5P Standalone in React</h1>\n\n      <div style={{ marginBottom: \"20px\", padding: \"10px\", border: \"1px solid #ccc\" }}>\n        <h3>Upload .h5p file</h3>\n        <input type=\"file\" accept=\".h5p,.zip\" onChange={handleFileChange} />\n        {loading && <span> Loading...</span>}\n      </div>\n\n      <h2>H5P Content</h2>\n      {/* Key is used to force re-mounting when path changes or just to refresh */}\n      {!loading && <PlayH5p key={h5pPath + Date.now()} h5pJsonPath={h5pPath} />}\n    </div>\n  );\n}\n"],"mappings":"AAAA,OAASA,QAAQ,KAAQ,OAAO,CAChC,MAAO,CAAAC,OAAO,KAAM,sBAAsB,CAC1C,OAASC,OAAO,KAAQ,wBAAwB,CAChD,MAAO,cAAc,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEtB,cAAe,SAAS,CAAAC,GAAGA,CAAA,CAAG,CAC5B,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGT,QAAQ,CAAC,oBAAoB,CAAC,CAC5D,KAAM,CAACU,OAAO,CAAEC,UAAU,CAAC,CAAGX,QAAQ,CAAC,KAAK,CAAC,CAE7C,KAAM,CAAAY,gBAAgB,CAAG,KAAO,CAAAC,KAAK,EAAK,CACxC,KAAM,CAAAC,IAAI,CAAGD,KAAK,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAClC,GAAI,CAACF,IAAI,CAAE,OAEXH,UAAU,CAAC,IAAI,CAAC,CAChB,GAAI,CACF,KAAM,CAAAM,EAAE,CAAG,KAAM,CAAAf,OAAO,CAACY,IAAI,CAAC,CAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACAL,UAAU,QAAQ,CAAC,CACrB,CAAE,MAAOS,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CAClDE,KAAK,CAAC,yBAAyB,CAAC,CAClC,CAAC,OAAS,CACRT,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,mBACEL,KAAA,QAAKe,SAAS,CAAC,KAAK,CAAAC,QAAA,eAClBlB,IAAA,OAAAkB,QAAA,CAAI,yBAAuB,CAAI,CAAC,cAEhChB,KAAA,QAAKiB,KAAK,CAAE,CAAEC,YAAY,CAAE,MAAM,CAAEC,OAAO,CAAE,MAAM,CAAEC,MAAM,CAAE,gBAAiB,CAAE,CAAAJ,QAAA,eAC9ElB,IAAA,OAAAkB,QAAA,CAAI,kBAAgB,CAAI,CAAC,cACzBlB,IAAA,UAAOuB,IAAI,CAAC,MAAM,CAACC,MAAM,CAAC,WAAW,CAACC,QAAQ,CAAEjB,gBAAiB,CAAE,CAAC,CACnEF,OAAO,eAAIN,IAAA,SAAAkB,QAAA,CAAM,aAAW,CAAM,CAAC,EACjC,CAAC,cAENlB,IAAA,OAAAkB,QAAA,CAAI,aAAW,CAAI,CAAC,CAEnB,CAACZ,OAAO,eAAIN,IAAA,CAACH,OAAO,EAA4B6B,WAAW,CAAEtB,OAAQ,EAA3CA,OAAO,CAAGuB,IAAI,CAACC,GAAG,CAAC,CAA0B,CAAC,EACtE,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}